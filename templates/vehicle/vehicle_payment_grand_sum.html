
{% extends "base.html" %}
{% load static %}

{% load duration_filters %}

{% block content %}

<style>

    table {
        border-collapse: collapse;
        width: 100%;
    
    }
    
    th,td{
        border: 1px solid black; /* Set border color for individual cells */
        text-align: left;
        padding: 0px;
    }
    
    th {
        background-color: rgb(38, 233, 129);
        
    }
    
    table thead th {
    white-space: normal;
    }
    
    .main-content {   
    overflow-y: auto;
    margin-left:0px;
    position: absolute;
    width: 100%;
    left: 0;
  
}
    
    </style>



<form method="GET" action="{% url 'vehicle:vehicle_grand_summary' %}">

    <div class="container-fluid">
        <div class="row row-cols-1 row-cols-md-4">

         <div class="col" style="padding:5px; margin:5px">  Start Date:  {{ form.start_date }} </div>
         <div class="col" style="padding:5px; margin:5px">  End Date:  {{ form.end_date }} </div>
         <div class="col" style="padding:5px; margin:5px"> No of days {{ form.days }} </div>
         <div class="col" style="padding:5px; margin:5px">  Region:{{ form.region }} </div>  
         <div class="col" style="padding:5px; margin:5px">  Zone:{{ form.zone }} </div>    
         <div class="col" style="padding:5px; margin:5px">  mp:{{ form.mp }} </div>    

         <div class="col" style="padding:5px; margin:5px"> <button type="submit" class='btn btn-primary'>Generate Data</button></div>
           
        </div>
    </div>
      
    </form>




<div style="left:0px; margin-left:0px">
    <h4 style="margin-top:40px; margin-left:0px">Data for
        {% if days %}
            the last {{ days }} days 
        {% elif start_date and end_date %}
            from: {{ start_date }} to {{ end_date }}
        {% endif %}
    </h4>
        
</div>


<h4 class="text-center">Vehicle cost performance summary</h4>

<div class="container-fluid main-content" >
    <div class="row">
        <div class="col">

  
            <table border="1">
                <thead>
                    <tr>
                        <th  class="text-center p-2">view details</th>
                        <th class="text-center p-2">Vehicle Registration Number</th>
                        <th class="text-center p-2">Zone</th>
                        <th class="text-center p-2">No of travel days</th>
                        <th class="text-center p-2">Vehicle daily Rent</th>
                        <th class="text-center p-2">Vehicle rental type</th>
                    
                        <th class="text-center p-2">Driver Over Time Rate</th>
                        <th class="text-center p-2">Body Over Time Rate</th>

                    
                        <th class="text-center p-2">Total vehicle running Hours</th>
                        <th class="text-center p-2">Total kilometer run from running data</th>
                        <th class="text-center p-2">Total kilometer run from refill data</th>
                        <th class="text-center p-2">Total fuel refill</th>
                        <th class="text-center p-2">Total fuel consumed</th>
                        <th class="text-center p-2">Total fuel balance</th>

                        <th class="text-center p-2">Total fuel consumed from refill</th>
                        <th class="text-center p-2">Total fuel balance from refill</th>
                       
                    

                        <th class="text-center p-2">Total TT handle</th>
                        <th class="text-center p-2">Total TT PGRH</th>
                        <th class="text-center p-2">Total overtime Hours</th>
                        <th class="text-center p-2">Total Fault Hours</th>                           

                        <th class="text-center p-2">Total Rent Due</th>
                        <th  class="text-center p-2">Total Driver Overtime Due</th>
                        <th  class="text-center p-2">Total body Overtime Due</th>
                        <th  class="text-center p-2">Total bill amount</th>

                        <th class="text-center p-2">Total Rent Paid</th>                
                        <th  class="text-center p-2">Total Driver Overtime Paid</th>
                        <th  class="text-center p-2">Total body Overtime Paid</th>
                        <th  class="text-center p-2">Total bill paid amount</th>

                       
                       

                    

                    </tr>
                </thead>
                <tbody>
              
                  
                    {% for vehicle_reg_number, data in aggregated_data_page %}
                    <tr>
                        <td style="white-space: nowrap">
                            <a href="{% url 'vehicle:vehicle_detail' data.vehicle_id %}">View details</a>
                        </td>                    
                        
                        <td class="text-center p-2" style="white-space: nowrap;">{{ vehicle_reg_number }}</td>
                        <td class="text-center p-2" style="white-space: nowrap;">{{ data.zone }}</td>
                        <td class="text-center p-2">{{ data.num_travel_dates }}</td>
                        <td class="text-center p-2">{{ data.vehicle_rent|first|floatformat:'2' }}</td>
                    
                        <td class="text-center p-2"> {{ data.vehicle_rental_type}}</td>
                    
                        <td class="text-center p-2">{{ data.driver_overtime_rate|first }}</td>
                        <td class="text-center p-2">{{ data.vehicle_body_overtime_rate|first }}</td>

                        <td class="text-center p-2">{{ data.total_running_hours|floatformat:'2' }}</td>
                        <td class="text-center p-2" style="background-color: burlywood;">{{ data.total_kilometer_run }}</td>
                        <td class="text-center p-2" style="background-color: rgb(170, 234, 21);">{{ data.total_kilometer_run_from_refill}}</td>
                        <td class="text-center p-2" style="background-color:red">{{ data.total_fuel_refil}}</td>
                        <td class="text-center p-2" style="background-color: burlywood;">{{ data.total_fuel_consumed }}</td>
                        <td class="text-center p-2" style="background-color: burlywood;">{{ data.total_fuel_balance }}</td>

                        <td class="text-center p-2"style="background-color: rgb(170, 234, 21);">{{ data.total_fuel_consumed_from_refil }}</td>
                        <td class="text-center p-2"style="background-color: rgb(170, 234, 21);">{{ data.total_fuel_balance_from_refil}}</td>
                       
                

                        <td class="text-center p-2">{{ data.total_tickets_handle }}</td>
                        <td class="text-center p-2">{{ data.total_pg_runhour_handle|floatformat:'2' }}</td>
                        <td class="text-center p-2">{{ data.total_overtime_run_hours|floatformat:'2' }}</td>
                        <td class="text-center p-2" style="background-color: rgb(241, 57, 57);">{{ data.total_fault_hours|floatformat:'2' }}</td>

                        <td class="text-center p-2">{{ data.total_vehicle_rent_due|floatformat:'2' }}</td>
                        <td class="text-center p-2">{{ data.total_overtime_cost|floatformat:'2' }}</td>
                        <td class="text-center p-2">{{ data.vehicle_body_overtime_cost|floatformat:'2' }}</td>

                        <td class="text-center p-2" style="background-color: aqua;">{{ data.total_vehicle_bill_amount|floatformat:'2' }}</td>

                        <td class="text-center p-2">{{ data.vehicle_rent_paid|floatformat:'2' }}</td>                   
                        <td class="text-center p-2">{{ data.vehicle_driver_overtime_paid|floatformat:'2' }}</td>
                        <td class="text-center p-2">{{ data.vehicle_body_overtime_paid|floatformat:'2' }}</td>
                        <td class="text-center p-2" style="background-color: aqua;">{{ data.total_bill_paid|floatformat:'2' }}</td>
                       
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

        </div>
    </div>


    
    <div class="pagination" style="padding:10px">
        {% if aggregated_data_page.has_previous %}
            <a style="margin:10px; font-size: 14px;" href="?page={{ aggregated_data_page.previous_page_number }}">Previous</a>
        {% endif %}
        
        {% for num in aggregated_data_page.paginator.page_range %}
            {% if aggregated_data_page.number == num %}
                <span style="margin:10px; font-size:14px">{{ num }}</span>
            {% else %}
                <a style="margin:10px; font-size:14px" href="?page={{ num }}">{{ num }}</a>
            {% endif %}
        {% endfor %}
        
        {% if aggregated_data_page.has_next %}
            <a style="margin:10px; font-size:14px" href="?page={{ aggregated_data_page.next_page_number }}">Next</a>
        {% endif %}
    </div>

</div>


    <div class="col" style="height:1200px"></div>



  {% endblock %}